webpackJsonp([3],{"9v1A":function(t,e,a){"use strict";e.a=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var a in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),e)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[a]:("00"+e[a]).substr((""+e[a]).length)));return t}},NlMd:function(t,e){},zyxG:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("O/gU"),s=a("9v1A");Date.prototype.Format=s.a;var r={name:"Publish",data:function(){return{dialogImageUrl:"",dialogVisible:!1,article:{title:"",content:""}}},methods:{handlePictureCardPreview:function(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},publish:function(){this.$store.state.isLogin?""===this.article.title.trim()?this.$message.info({message:"标题不能为空！",duration:1e3}):""===this.article.content.trim()?this.$message.info({message:"内容不能为空！",duration:1e3}):this.$refs.upImg.submit():this.$message.info({message:"请先登录！",duration:1e3})},beforeAvatarUpload:function(t){var e=this;if(!(t.size/1024/1024<2))return this.$message.error("上传头像图片大小不能超过 2MB!"),!1;var a=this.$store.state.userMsg,i=new FormData;i.append("file",t),i.append("uid",a._id),i.append("username",a.userName),i.append("authorHeadImg",a.headimgSrc),i.append("time",(new Date).Format("yyyy-MM-dd hh:mm")),i.append("title",this.article.title),i.append("content",this.article.content);this.$ajax.post("/admin/publish",i,{header:{"Content-Type":"multipart/form-data"}}).then(function(t){console.log(t.data),t.data.status?e.$message.success("发布成功"):e.$message.error("发布失败")}).catch(function(){e.$message.error("发布失败，请稍后重试！")})},limitNum:function(){this.$message.error({message:"只能上传一个文件",duration:1e3})}},components:{NavTab:i.a}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"publish"},[a("NavTab",{attrs:{active:1}}),t._v(" "),a("div",{staticClass:"header"},[t._v("发布页面")]),t._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"input-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.article.title,expression:"article.title"}],staticClass:"title",attrs:{type:"text",placeholder:"请输入标题"},domProps:{value:t.article.title},on:{input:function(e){e.target.composing||t.$set(t.article,"title",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"area-group"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.article.content,expression:"article.content"}],attrs:{name:"",id:"",cols:"30",rows:"10",placeholder:"详细描述"},domProps:{value:t.article.content},on:{input:function(e){e.target.composing||t.$set(t.article,"content",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"img-wrap"},[a("el-upload",{ref:"upImg",attrs:{action:"","list-type":"picture-card","on-preview":t.handlePictureCardPreview,"auto-upload":!1,accept:"image/jpeg,image/gif,image/png,image/bmp",limit:1,"on-exceed":t.limitNum,"before-upload":t.beforeAvatarUpload}},[a("i",{staticClass:"el-icon-plus"})]),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1),t._v(" "),a("div",{staticClass:"btn-wrap"},[a("el-button",{attrs:{type:"success",round:""},on:{click:t.publish}},[t._v("发布")])],1)])],1)},staticRenderFns:[]};var o=a("VU/8")(r,n,!1,function(t){a("NlMd")},"data-v-846ab0bc",null);e.default=o.exports}});
//# sourceMappingURL=3.36b48e064aeeb4bb2df4.js.map