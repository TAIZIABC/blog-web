webpackJsonp([4],{"9v1A":function(t,i,s){"use strict";i.a=function(t){var i={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var s in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),i)new RegExp("("+s+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[s]:("00"+i[s]).substr((""+i[s]).length)));return t}},MIom:function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=s("X5Fx"),e=s("9v1A");Date.prototype.Format=e.a;var n={name:"Detail",data:function(){return{follow:!1,commentBox:!1,footBox:!0,collection:!1,zan:!1,cai:!1,ratingVal:"",article:{},ratings:[{id:1,userName:"taizi",userHeadImg:"https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=941310360,2054712345&fm=27&gp=0.jpg",time:"06.29 09:22",content:"作者是有怎样的才华，才能把小事表现的淋漓尽致的。",zan:4,cai:5},{id:1,userName:"taizi",userHeadImg:"https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=941310360,2054712345&fm=27&gp=0.jpg",time:"06.29 09:22",content:"作者是有怎样的才华，才能把小事表现的淋漓尽致的。",zan:4,cai:5},{id:1,userName:"taizi",userHeadImg:"https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=941310360,2054712345&fm=27&gp=0.jpg",time:"06.29 09:22",content:"作者是有怎样的才华，才能把小事表现的淋漓尽致的。",zan:4,cai:5}],isLogin:!1}},methods:{commentFun:function(){this.commentBox=!0,this.footBox=!1},commentFuns:function(){this.commentBox=!1,this.footBox=!0},stopFun:function(){return!1},coll:function(){var t=this;if(this.isLogin){this.collection=!this.collection;var i=this.collection;this.$ajax.post("/article/soucan",{aid:this.article._id,uid:this.$store.state.userMsg._id,action:i}).then(function(t){}).catch(function(){t.$message.error({message:"请稍后重试！",duration:1e3})})}else this.$message.error({message:"请先登入！",duration:1e3})},zanFun:function(){if(this.isLogin){this.zan=!this.zan,this.zan?this.article.zan++:this.article.zan--;var t=this.zan?1:-1;this.$ajax.post("/article/zan",{tag:"zan",aid:this.article._id,action:t}).then(function(t){})}else this.$message.error({message:"请先登入！",duration:1e3})},caiFun:function(){if(this.isLogin){this.cai=!this.cai,this.cai?this.article.cai++:this.article.cai--;var t=this.cai?1:-1;this.$ajax.post("/article/zan",{tag:"cai",aid:this.article._id,action:t}).then(function(t){})}else this.$message.error({message:"请先登入！",duration:1e3})},ratingZan:function(t){this.ratings[t].zan++,this.$ajax.post("/article/comment",{id:this.ratings[t]._id,tag:"zan"}).then(function(t){})},ratingCai:function(t){this.ratings[t].cai++,this.$ajax.post("/article/comment",{id:this.ratings[t]._id,tag:"cai"}).then(function(t){})},publish:function(){if(this.ratingVal)if(this.isLogin){var t={worksId:this.article._id,userId:this.$store.state.userMsg._id,userName:this.$store.state.userMsg.userName,userHeadImg:this.$store.state.userMsg.headimgSrc,time:(new Date).Format("MM.dd hh:mm"),content:this.ratingVal,zan:0,cai:0};this.$ajax.post("/article/comment",{tag:"comment",content:t}).then(function(t){}),this.ratings.unshift(t),this.ratingVal="",this.commentFuns()}else this.$message.error({message:"请先登入！",duration:1e3});else this.$message.error({message:"请输入内容！",duration:1e3})},followFun:function(){if(this.isLogin){this.follow=!this.follow;var t=this.follow,i=this.$store.state.userMsg._id,s=this.article.userId;this.$ajax.post("/admin/follow",{action:t,uid:i,authorId:s}).then(function(t){console.log(t.data)})}else this.$message.error({message:"请先登入！",duration:1e3})}},created:function(){var t=this,i=this.$route.query.id,s=this.$store.state.articles.filter(function(t){return t._id===i});this.article=s[0],this.$ajax.post("/article/detail",{id:i}).then(function(i){t.ratings=i.data.comment}).catch(function(i){t.$message.error({message:"网络错误！",duration:1e3})}),this.isLogin=this.$store.state.isLogin},components:{Heads:a.a}},o={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"detail"},[s("div",{staticClass:"head-wrap"},[s("Heads")],1),t._v(" "),s("div",{staticClass:"title"},[s("h2",[t._v(t._s(t.article.title))])]),t._v(" "),s("div",{staticClass:"author"},[s("img",{staticClass:"avator",attrs:{src:t.article.authorHeadImg,alt:""}}),t._v(" "),s("span",{staticClass:"author_name"},[t._v(t._s(t.article.author))]),t._v(" "),s("el-button",{staticClass:"follow",attrs:{type:"success",size:"small"},on:{click:t.followFun}},[t._v(t._s(t.follow?"已关注":"关注"))])],1),t._v(" "),s("div",{staticClass:"time"},[t._v("发布于："+t._s(t.article.time))]),t._v(" "),s("div",{staticClass:"content"},[s("img",{directives:[{name:"show",rawName:"v-show",value:t.article.worksSrc,expression:"article.worksSrc"}],staticClass:"content-img",attrs:{src:t.article.worksSrc}}),t._v(" "),s("p",[t._v(t._s(t.article.content))])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.footBox,expression:"footBox"}],staticClass:"footer"},[s("li",{staticClass:"item",on:{click:t.commentFun}},[s("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{"xlink:href":"#icon-pinglun"}})]),t._v(" "),s("p",[t._v("评论"+t._s(t.ratings.length))])]),t._v(" "),s("li",{staticClass:"item",on:{click:t.coll}},[s("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{href:t.collection?"#icon-xin2":"#icon-zan"}})]),t._v(" "),s("p",[t._v("收藏"+t._s(t.article.likeUserId.length))])]),t._v(" "),s("li",{staticClass:"item",on:{click:t.zanFun}},[s("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{href:t.zan?"#icon-zan11":"#icon-icon_good"}})]),t._v(" "),s("p",[t._v("赞"+t._s(t.article.zan))])]),t._v(" "),s("li",{staticClass:"item",on:{click:t.caiFun}},[s("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[s("use",{attrs:{href:t.cai?"#icon-cai2":"#icon-cai"}})]),t._v(" "),s("p",[t._v("踩"+t._s(t.article.cai))])])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.commentBox,expression:"commentBox"}],staticClass:"comment-box",on:{click:t.commentFuns}},[s("div",{staticClass:"box",on:{click:function(i){return i.stopPropagation(),t.stopFun(i)}}},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.ratingVal,expression:"ratingVal"}],staticClass:"comment-txt",attrs:{type:"text"},domProps:{value:t.ratingVal},on:{input:function(i){i.target.composing||(t.ratingVal=i.target.value)}}}),t._v(" "),s("button",{staticClass:"publish",on:{click:t.publish}},[t._v("发表评论")])])]),t._v(" "),s("div",{staticClass:"comment"},[s("div",{staticClass:"comment-head"},[s("span",[t._v("评论("+t._s(t.ratings.length)+")")])]),t._v(" "),t._l(t.ratings,function(i,a){return s("li",{staticClass:"comment-item"},[s("div",{staticClass:"comment-item-head"},[s("img",{staticClass:"user-avatar",attrs:{src:i.userHeadImg,alt:""}}),t._v(" "),s("div",{staticClass:"user-name"},[s("span",[t._v(t._s(i.userName))]),t._v(" \n            "),s("span",{staticClass:"time"},[t._v(t._s(i.time))])]),t._v(" "),s("div",{staticClass:"item-right"},[s("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"},on:{click:function(i){t.ratingZan(a)}}},[s("use",{attrs:{"xlink:href":"#icon-icon_good"}})]),t._v(t._s(i.zan)+"\n                 \n            "),s("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"},on:{click:function(i){t.ratingCai(a)}}},[s("use",{attrs:{"xlink:href":"#icon-cai"}})]),t._v(t._s(i.cai)+"\n          ")])]),t._v(" "),s("div",{staticClass:"comment-item-body"},[s("p",[t._v(t._s(i.content))])])])}),t._v(" "),s("div",{staticClass:"comment-footer"},[t._v("\n      --end--\n    ")])],2)])},staticRenderFns:[]};var c=s("VU/8")(n,o,!1,function(t){s("mQ6N")},"data-v-1669c726",null);i.default=c.exports},mQ6N:function(t,i){}});
//# sourceMappingURL=4.1c7818929983193c99f6.js.map